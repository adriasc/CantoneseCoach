<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Cantonese Coach</title>
  <meta name="theme-color" content="#112d4e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="CanCoach">
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icons/icon-192.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="bg-shape shape-a"></div>
  <div class="bg-shape shape-b"></div>

  <main class="app-shell">
    <header class="topbar">
      <div>
        <p class="eyebrow">Daily Cantonese <span class="version-tag">v17</span></p>
        <h1>Cantonese Coach</h1>
      </div>
      <div class="streak" id="streakBadge">Streak: 0 days</div>
    </header>

    <nav class="tabs">
      <button class="tab is-active" data-tab="words">Words</button>
      <button class="tab" data-tab="patterns">Patterns</button>
      <button class="tab" data-tab="listening">Listening</button>
      <button class="tab" data-tab="tones">Tones</button>
      <button class="tab" data-tab="settings">Content</button>
    </nav>

    <section class="card controls-card">
      <h2>Practice Controls</h2>
      <div class="slot-grid controls-grid">
        <div>
          <label for="globalLevel">Level (all exercises)</label>
          <select id="globalLevel">
            <option value="1">Level 1 - very short</option>
            <option value="2">Level 2 - short</option>
            <option value="3">Level 3 - medium</option>
            <option value="4">Level 4 - advanced</option>
            <option value="5">Level 5 - long/conditional</option>
          </select>
        </div>
        <div>
          <label for="globalTense">Verb Time</label>
          <select id="globalTense">
            <option value="mixed">Mixed</option>
            <option value="present">Present</option>
            <option value="past">Past</option>
            <option value="future">Future</option>
            <option value="conditional">Conditional</option>
          </select>
        </div>
        <div>
          <label for="globalTheme">Theme</label>
          <select id="globalTheme">
            <option value="mixed">Mixed</option>
            <option value="home">Home/Family</option>
            <option value="friends">Friends</option>
            <option value="travel">Travel/Going out</option>
            <option value="daily">Daily routines</option>
            <option value="holiday">Holiday plans</option>
          </select>
        </div>
        <div>
          <label for="audioVoice">Audio Voice</label>
          <select id="audioVoice">
            <option value="auto">Auto (best Cantonese)</option>
          </select>
        </div>
        <div>
          <label for="audioRate">Audio Speed (<span id="audioRateValue">0.90x</span>)</label>
          <input id="audioRate" type="range" min="0.6" max="1.2" step="0.05" value="0.9">
        </div>
      </div>
      <div class="actions">
        <button id="applyControls">Apply Settings</button>
        <button id="testVoice">Test Voice</button>
      </div>
      <p class="example" id="controlsMessage"></p>
    </section>

    <section class="panel is-active" id="panel-words">
      <div class="card" id="wordCard">
        <p class="chip" id="wordCategory">Category</p>
        <h2 class="hanzi" id="wordHanzi">我</h2>
        <p class="jyutping" id="wordJyutping">ngo5</p>
        <p class="english" id="wordEnglish">I / me</p>
        <div class="actions">
          <button id="playWordAudio">Play audio</button>
          <button id="revealExample">Show example</button>
          <button id="toggleWordJyutping">Hide Jyutping</button>
          <button id="toggleWordEnglish">Hide English</button>
          <button id="markKnown">I know this</button>
          <button id="nextWord">Next</button>
        </div>
        <p class="example" id="wordExample"></p>
      </div>
      <div class="mini-stats">
        <p id="knownWords">Known words: 0</p>
        <p id="reviewedWords">Reviewed today: 0</p>
      </div>
    </section>

    <section class="panel" id="panel-patterns">
      <div class="card">
        <h2>Sentence Practice</h2>
        <p class="formula" id="patternFormula"></p>
        <div class="slot-grid" id="slotGrid"></div>
        <div class="result-box">
          <p class="hanzi" id="patternHanzi"></p>
          <p class="jyutping" id="patternJyutping"></p>
          <p class="english" id="patternEnglish"></p>
          <p class="literal" id="patternLiteral"></p>
          <div class="grammar-notes" id="patternGrammarNotes"></div>
        </div>
        <div class="actions">
          <button id="playPatternAudio">Play sentence</button>
          <button id="toggleGrammarLens">Grammar Lens: Off</button>
          <button id="togglePatternJyutping">Hide Jyutping</button>
          <button id="togglePatternEnglish">Hide English</button>
          <button id="newPattern">Next pattern</button>
        </div>
      </div>
    </section>

    <section class="panel" id="panel-listening">
      <div class="card">
        <h2>Listening Quiz</h2>
        <p>Tap play, listen, then choose the correct English meaning.</p>
        <p class="hanzi hidden" id="quizHanzi"></p>
        <p class="jyutping hidden" id="quizJyutping"></p>
        <p class="english hidden" id="quizEnglish"></p>
        <p class="literal" id="quizLiteral"></p>
        <div class="grammar-notes" id="quizGrammarNotes"></div>
        <div class="actions">
          <button id="playQuizAudio">Play clip</button>
          <button id="showQuizText">Show Chinese</button>
          <button id="toggleQuizJyutping">Show/Hide Jyutping</button>
          <button id="toggleQuizEnglish">Show/Hide English</button>
          <button id="nextQuiz">Next quiz</button>
        </div>
        <div class="choices" id="quizChoices"></div>
        <p class="feedback" id="quizFeedback"></p>
      </div>
    </section>

    <section class="panel" id="panel-tones">
      <div class="card">
        <h2>Tone Contrast Drills</h2>
        <p>Press A, B, or Random. Then choose the English meaning of the clip you just heard.</p>
        <p class="formula" id="toneLabel"></p>
        <p class="example" id="tonePrompt">Step 1: Play a clip. Step 2: Choose meaning below.</p>
        <div class="result-box">
          <p class="hanzi tone-line" id="toneHanzi"></p>
          <p class="jyutping tone-line" id="toneJyutping"></p>
          <p class="english tone-line" id="toneEnglish"></p>
        </div>
        <div class="actions">
          <button id="playToneA">Play A</button>
          <button id="playToneB">Play B</button>
          <button id="playToneRandom">Play Random</button>
          <button id="toggleToneJyutping">Hide Jyutping</button>
          <button id="toggleToneEnglish">Hide English</button>
          <button id="nextTone">Next pair</button>
        </div>
        <div class="choices" id="toneChoices"></div>
        <p class="feedback" id="toneFeedback"></p>
        <p class="example" id="toneScore">Tone score: 0 / 0</p>
      </div>
    </section>

    <section class="panel" id="panel-settings">
      <div class="card">
        <h2>Content Manager</h2>
        <p>Your app uses built-in basic words now. Import your own JSON to match your exact PDF list.</p>
        <div class="actions">
          <label class="file-btn" for="importFile">Import JSON</label>
          <input id="importFile" type="file" accept="application/json">
          <button id="exportData">Export current JSON</button>
          <button id="resetData">Reset built-in words</button>
        </div>
        <details>
          <summary>Expected JSON format</summary>
          <pre>{
  "words": [
    {
      "id": "w1",
      "hanzi": "我",
      "jyutping": "ngo5",
      "english": "I / me",
      "category": "pronoun",
      "example": "我學廣東話。"
    }
  ],
  "patterns": [...],
  "quiz": [...]
}</pre>
        </details>
        <p id="contentMessage"></p>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
